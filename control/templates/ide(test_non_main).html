<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêi·ªÅu khi·ªÉn ESP32 b·∫±ng gi·ªçng n√≥i</title>
</head>
<body>
    <h1>√Ånh s√°ng: <span id="light-value">ƒêang t·∫£i...</span></h1>
    <button onclick="startVoiceControl()">üé§ ƒêi·ªÅu khi·ªÉn ƒë√®n b·∫±ng gi·ªçng n√≥i</button>

    <script>
        function fetchLightData() {
            fetch('/api/light/')
                .then(response => response.json())
                .then(data => {
                    document.getElementById("light-value").innerText = data.light;
                });
        }
        setInterval(fetchLightData, 2000);

        function sendCommand(command) {
            fetch('/api/led/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ command: command })
            });
        }

        function startVoiceControl() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'vi-VN';
            recognition.start();

            recognition.onresult = function(event) {
                const voiceText = event.results[0][0].transcript.toLowerCase();
                console.log("B·∫°n n√≥i: ", voiceText);

                if (voiceText.includes("ƒëi ng·ªß")) sendCommand("ƒêi ng·ªß");
                else if (voiceText.includes("l√†m vi·ªác")) sendCommand("L√†m vi·ªác");
                else if (voiceText.includes("ƒÉn c∆°m")) sendCommand("ƒÇn c∆°m");
                else if (voiceText.includes("gi·∫£i tr√≠")) sendCommand("Gi·∫£i tr√≠");
                else if (voiceText.includes("xem phim")) sendCommand("Xem phim");
                else if (voiceText.includes("b·∫≠t")) sendCommand("B·∫≠t");
                else if (voiceText.includes("t·∫Øt")) sendCommand("T·∫Øt");
            };
        }
    </script>
</body>
</html>
